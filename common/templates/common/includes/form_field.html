<!-- common/templates/common/includes/form_field.html -->

<div class="form-field-wrapper" 
     data-field-name="{{ field.name }}"
     style="width: {{ field.width|default:'100%' }}; flex: 0 0 {{ field.width|default:'100%' }};">
    <div class="form-group">
        <label for="{{ field.name }}" {% if field.required %}class="required"{% endif %}>
            {{ field.label }}
            <span class="design-indicator" style="display: none;">✏️</span>
        </label>
        
        {% if field.type == 'text' %}
            <input type="text" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   value="{{ field.value|default:'' }}"
                   placeholder="{{ field.placeholder|default:'' }}"
                   {% if field.required %}required{% endif %}
                   {% if field.readonly %}readonly{% endif %}
                   {% if field.maxlength %}maxlength="{{ field.maxlength }}"{% endif %}>
        
        {% elif field.type == 'email' %}
            <input type="email" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   value="{{ field.value|default:'' }}"
                   placeholder="{{ field.placeholder|default:'' }}"
                   {% if field.required %}required{% endif %}>
        
        {% elif field.type == 'number' %}
            <input type="number" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   value="{{ field.value|default:'' }}"
                   placeholder="{{ field.placeholder|default:'' }}"
                   {% if field.required %}required{% endif %}
                   {% if field.min %}min="{{ field.min }}"{% endif %}
                   {% if field.max %}max="{{ field.max }}"{% endif %}
                   {% if field.step %}step="{{ field.step }}"{% endif %}>
        
        {% elif field.type == 'password' %}
            <input type="password" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   placeholder="{{ field.placeholder|default:'Enter password' }}"
                   {% if field.required %}required{% endif %}>
        
        {% elif field.type == 'textarea' %}
            <textarea id="{{ field.name }}" 
                      name="{{ field.name }}" 
                      class="form-input form-textarea" 
                      placeholder="{{ field.placeholder|default:'' }}"
                      {% if field.required %}required{% endif %}
                      {% if field.rows %}rows="{{ field.rows }}"{% endif %}>{{ field.value|default:'' }}</textarea>
        
        {% elif field.type == 'select' %}
            <select id="{{ field.name }}" 
                    name="{{ field.name }}" 
                    class="form-input" 
                    {% if field.required %}required{% endif %}>
                {% if field.placeholder %}
                    <option value="">{{ field.placeholder }}</option>
                {% endif %}
                {% for option in field.options %}
                    <option value="{{ option.value }}" {% if option.value == field.value %}selected{% endif %}>
                        {{ option.label }}
                    </option>
                {% endfor %}
            </select>
        
        {% elif field.type == 'checkbox' %}
            <div class="checkbox-wrapper">
                <input type="checkbox" 
                       id="{{ field.name }}" 
                       name="{{ field.name }}" 
                       value="1"
                       {% if field.checked %}checked{% endif %}>
                <label for="{{ field.name }}" class="checkbox-label">{{ field.checkbox_label }}</label>
            </div>
        
        {% elif field.type == 'radio' %}
            <div class="radio-group">
                {% for option in field.options %}
                    <div class="radio-option">
                        <input type="radio" 
                               id="{{ field.name }}_{{ option.value }}" 
                               name="{{ field.name }}" 
                               value="{{ option.value }}"
                               {% if option.value == field.value %}checked{% endif %}>
                        <label for="{{ field.name }}_{{ option.value }}">{{ option.label }}</label>
                    </div>
                {% endfor %}
            </div>
        
        {% elif field.type == 'date' %}
            <input type="date" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   value="{{ field.value|default:'' }}"
                   {% if field.required %}required{% endif %}>
        
        {% elif field.type == 'file' %}
            <input type="file" 
                   id="{{ field.name }}" 
                   name="{{ field.name }}" 
                   class="form-input" 
                   {% if field.required %}required{% endif %}
                   {% if field.accept %}accept="{{ field.accept }}"{% endif %}>
        
        {% endif %}
        
        {% if field.help_text %}
            <small class="form-help-text">{{ field.help_text }}</small>
        {% endif %}
        
        {% if field.error %}
            <small class="form-error-text">{{ field.error }}</small>
        {% endif %}
    </div>
</div>

<style>
.form-field-wrapper {
    padding: 5px;
    box-sizing: border-box;
    transition: all 0.3s ease;
}

.form-field-wrapper.design-mode-active {
    border: 2px dashed #667eea;
    background: rgba(102, 126, 234, 0.05);
    cursor: pointer;
    position: relative;
}

.form-field-wrapper.design-mode-active:hover {
    background: rgba(102, 126, 234, 0.1);
    border-color: #764ba2;
}

.form-field-wrapper.design-mode-active .design-indicator {
    display: inline-block !important;
    margin-left: 5px;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    margin-bottom: 5px;
    font-weight: 500;
    color: #333;
    font-size: 14px;
}

label.required:after {
    content: " *";
    color: #dc3545;
}

.form-input {
    padding: 10px 12px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-size: 14px;
    transition: border-color 0.2s;
    width: 100%;
    box-sizing: border-box;
}

.form-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-input:disabled,
.form-input:readonly {
    background-color: #e9ecef;
    cursor: not-allowed;
}

.form-textarea {
    min-height: 100px;
    resize: vertical;
}

.form-help-text {
    margin-top: 5px;
    color: #6c757d;
    font-size: 12px;
}

.form-error-text {
    margin-top: 5px;
    color: #dc3545;
    font-size: 12px;
}

.checkbox-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 0;
}

.checkbox-wrapper input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.checkbox-label {
    margin: 0;
    cursor: pointer;
    font-weight: normal;
}

.radio-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 10px 0;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 8px;
}

.radio-option input[type="radio"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.radio-option label {
    margin: 0;
    cursor: pointer;
    font-weight: normal;
}
</style>