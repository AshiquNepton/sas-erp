{% load static %}

<!-- Base Form Template - Reusable for all forms -->
<div class="base-form-container" id="{{ form_id }}" data-state="normal">
    
    <!-- Form Header with Window Controls -->
    <div class="form-header">
        <div class="form-title">
            <span class="form-icon">üìù</span>
            <h3>{{ form_title }}</h3>
        </div>
        <div class="form-controls">
            <button type="button" class="btn-control btn-minimize" onclick="minimizeForm('{{ form_id }}')" title="Minimize">
                <span>_</span>
            </button>
            <button type="button" class="btn-control btn-maximize" onclick="maximizeForm('{{ form_id }}')" title="Maximize">
                <span>‚ñ°</span>
            </button>
            <button type="button" class="btn-control btn-close" onclick="closeForm('{{ form_id }}')" title="Close">
                <span>‚úï</span>
            </button>
        </div>
    </div>

    <!-- Form Action Buttons Area -->
    <div class="form-button-area">
        {% if buttons %}
            {% for button in buttons %}
                <button 
                    type="{{ button.type|default:'button' }}" 
                    class="btn btn-{{ button.style|default:'secondary' }}"
                    onclick="{{ button.action }}"
                    {% if button.id %}id="{{ button.id }}"{% endif %}
                >
                    {% if button.icon %}
                        <span class="btn-icon">{{ button.icon }}</span>
                    {% endif %}
                    {{ button.label }}
                </button>
            {% endfor %}
        {% endif %}
    </div>

    <!-- Form Content Area -->
    <div class="form-content">
        <form method="post" action="{{ form_action }}" id="{{ form_id }}-form" {% if enctype %}enctype="{{ enctype }}"{% endif %}>
            {% csrf_token %}
            
            <!-- Form Fields will be inserted here -->
            {{ form_fields|safe }}
            
        </form>
    </div>

    <!-- Form Footer (optional) -->
    {% comment %} {% if show_footer %}
    <div class="form-footer">
        <div class="form-info">
            <span class="form-status">{{ form_status|default:'Ready' }}</span>
        </div>
    </div>
    {% endif %} {% endcomment %}

</div>

<!-- Overlay for modal effect -->
<div class="form-overlay" id="{{ form_id }}-overlay" onclick="closeForm('{{ form_id }}')"></div>

<style>
.base-form-container {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin: 20px 0;
    overflow: hidden;
}

.form-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.form-title {
    display: flex;
    align-items: center;
    gap: 10px;
}

.form-title h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
}

.form-controls {
    display: flex;
    gap: 5px;
}

.btn-control {
    width: 30px;
    height: 30px;
    border: none;
    background: rgba(255,255,255,0.2);
    color: white;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.btn-control:hover {
    background: rgba(255,255,255,0.3);
}

.form-button-area {
    display: flex;
    gap: 10px;
    padding: 15px 20px;
    background: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #5a6268;
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-success:hover {
    background: #218838;
}

.form-content {
    padding: 20px;
}

.form-footer {
    padding: 15px 20px;
    background: #f8f9fa;
    border-top: 1px solid #dee2e6;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.form-status {
    color: #6c757d;
    font-size: 14px;
}

.form-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 999;
}

/* Form states */
.base-form-container[data-state="minimized"] .form-content,
.base-form-container[data-state="minimized"] .form-button-area,
.base-form-container[data-state="minimized"] .form-footer {
    display: none;
}

.base-form-container[data-state="maximized"] {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1000;
    margin: 0;
    border-radius: 0;
}

.base-form-container[data-state="closed"] {
    display: none;
}
</style>

<script>
function openForm(formId) {
    const form = document.getElementById(formId);
    if (form) {
        form.setAttribute('data-state', 'normal');
    }
}

function ∆í(formId) {
    const form = document.getElementById(formId);
    if (form) {
        const currentState = form.getAttribute('data-state');
        form.setAttribute('data-state', currentState === 'minimized' ? 'normal' : 'minimized');
    }
}

function maximizeForm(formId) {
    const form = document.getElementById(formId);
    const overlay = document.getElementById(formId + '-overlay');
    if (form) {
        const currentState = form.getAttribute('data-state');
        const newState = currentState === 'maximized' ? 'normal' : 'maximized';
        form.setAttribute('data-state', newState);
        if (overlay) {
            overlay.style.display = newState === 'maximized' ? 'block' : 'none';
        }
    }
}

function closeForm(formId) {
    const form = document.getElementById(formId);
    const overlay = document.getElementById(formId + '-overlay');
    if (form) {
        form.setAttribute('data-state', 'closed');
    }
    if (overlay) {
        overlay.style.display = 'none';
    }
}
</script>